function startChatbot() {
    console.log("Chatbot initialized...");

    // Function to send messages to Make.com Webhook
    async function sendMessage(message) {
        console.log("User:", message);

        try {
            const response = await fetch("https://hook.us1.make.com/7obx2jgtkfdp6i36mx78yamsguub13ah", {  
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ text: message })  
            });

            // âœ… Handle plain text & JSON responses
            const contentType = response.headers.get("Content-Type");
            let data;
            if (contentType && contentType.includes("application/json")) {
                data = await response.json();
            } else {
                data = await response.text();  // Read plain text response
            }

            console.log("Make.com Response:", data);
            addMessage("Bot", data); // Display bot response in chat
        } catch (error) {
            console.error("Error sending message:", error);
        }
    }

    // Create Chat UI
    function createChatUI() {
        let chatContainer = document.createElement("div");
        chatContainer.style.position = "fixed";
        chatContainer.style.bottom = "20px";
        chatContainer.style.right = "20px";
        chatContainer.style.width = "300px";
        chatContainer.style.height = "400px";
        chatContainer.style.background = "#fff";
        chatContainer.style.border = "1px solid #ccc";
        chatContainer.style.boxShadow = "0 0 10px rgba(0,0,0,0.1)";
        chatContainer.style.padding = "10px";
        chatContainer.style.overflowY = "auto";
        chatContainer.style.display = "flex";
        chatContainer.style.flexDirection = "column";
        chatContainer.style.alignItems = "center";

        let chatHeader = document.createElement("div");
        chatHeader.innerText = "Chatbot";
        chatHeader.style.background = "#50b3a2";
        chatHeader.style.color = "#fff";
        chatHeader.style.width = "100%";
        chatHeader.style.textAlign = "center";
        chatHeader.style.padding = "10px";
        chatContainer.appendChild(chatHeader);

        let chatMessages = document.createElement("div");
        chatMessages.style.flexGrow = "1";
        chatMessages.style.width = "100%";
        chatMessages.style.overflowY = "auto";
        chatMessages.style.padding = "10px";
        chatMessages.id = "chatMessages";
        chatContainer.appendChild(chatMessages);

        let chatInput = document.createElement("input");
        chatInput.type = "text";
        chatInput.placeholder = "Type a message...";
        chatInput.style.width = "90%";
        chatInput.style.margin = "5px";
        chatInput.style.padding = "8px";
        chatInput.style.border = "1px solid #ccc";
        chatInput.style.borderRadius = "5px";
        chatInput.style.outline = "none";

        chatInput.addEventListener("keypress", function (event) {
            if (event.key === "Enter" && chatInput.value.trim() !== "") {
                let userMessage = chatInput.value.trim();
                addMessage("You", userMessage);
                sendMessage(userMessage);
                chatInput.value = "";
            }
        });

        chatContainer.appendChild(chatInput);
        document.body.appendChild(chatContainer);
    }

    // Function to add messages to chat
    function addMessage(sender, message) {
        let chatMessages = document.getElementById("chatMessages");
        if (!chatMessages) return;

        let msgDiv = document.createElement("div");
        msgDiv.innerHTML = `<strong>${sender}:</strong> ${message}`;
        msgDiv.style.marginBottom = "10px";
        chatMessages.appendChild(msgDiv);

        // Auto-scroll to the latest message
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    createChatUI();

    return { sendMessage };
}

// Start the chatbot when the page loads
document.addEventListener("DOMContentLoaded", startChatbot);
